{
  "commands":[{
    "description":"These are sample commands to demonstrate calling a REST service from GCLI "
  },
  {
    "name":"command",
    "description":"an example command",
    "returnType":"string",
    "params":[
    {
      "name":"arg",
      "type": {
        "name":"selection",
        "dataAction":{
          "url":"http://%{host}/static/values.json",
          "expression":"$.results[*]"
        }},
      "description":"an example arg that gets its complete actions from a web service call"
    }
    ],
        "execAction":{
          "url":"http://%{host}/call/${arg}",
          "expression":"$.Result",
          "callbackData":{"foo":"bar","wibble":{"type":"expression","expression":"$.response.Result","extract":true}}
        }
  },
  {
    "name":"session",
    "description":"manipulate ZAP sessions"
  },
  {
    "name":"session new",
    "description":"create a new session",
    "returnType":"string",
    "params":[
    {
      "name":"name",
      "type": "string",
      "description":"the name of the new session to create"
    }
    ],
        "execAction":{
          "url":"http://localhost:8080/JSON/core/action/newSession/?zapapiformat=JSON&name=${name}",
          "expression":"$.Result",
          "callbackData":{"foo":"bar","wibble":{"type":"expression","expression":"$.response.Result","extract":true}}
        }
  }, {
    "name":"brk",
    "description":"create a new session",
    "returnType":"string",
    "params":[
    {
      "name":"state",
      "type": {"name":"selection", "data":["on","off"]},
      "description": "break on request",
      "defaultValue": "on"
    },
    {
      "name":"scope",
      "type": {"name":"selection", "data":["tab","global"]},
      "description": "local to tab or global",
      "defaultValue": "tab"
    }
    ],
    "execAction":{
      "expression":"$.Result",
      "callbackData":{
        "conditionalCommands":{
          "expression":"$.args.state",
          "states":{
            "on":[{
              "command":"addToHeader",
              "params": {
                "headerName":"X-Security-Proxy",
                "value":"intercept",
                "scope":{"type":"expression","expression":"$.args.scope","extract":true}
              }
            }],
            "off":[{
              "command":"removeFromHeader",
              "params": {
                "headerName":"X-Security-Proxy",
                "value":"intercept",
                "scope":{"type":"expression","expression":"$.args.scope","extract":true}
              }
            }]
          }
        }
      }
    }
  }]
}
